.. image:: https://img.shields.io/badge/licence-LGPL--3-blue.svg
   :target: http://www.gnu.org/licenses/lgpl-3.0-standalone.html
   :alt: License: LGPL-3

======================================
Print Invoice Payment Receipt - Portal
======================================

このモジュールは、カスタマがポータルページから領収書をダウンロードするための機能を追加します。

このモジュールは、Probuse Consulting Service Pvt. Ltd.作成のプライベートモジュール ``invoice_payment_receipt`` に依存します。

設定
====

特別な設定はなし。モジュールをインストールするのみ。

使用方法
========

ポータル画面（マイアカウント > 請求書と支払）に入金済の請求書につき、「領収書ダウンロード」ボタンが追加される。
このボタンを押すと、領収書のPDFファイルがダウンロードされる。

依存モジュール（ ``invoice_payment_receipt`` ）選定理由
===================================================

LGPLライセンスで適当な領収書印刷機能がなかったため、プロプライエタリモジュールで使えそうなものを検索。
複数候補があったうち、入金ではなく請求書をベースに印刷機能を追加するという点でカスタマポータル機能との親和性が
高かった（「請求書と支払」画面に表示されるレコードは請求書ベース）ため、当該モジュールを使用することとした。


設計方針（既存モジュールとの関係）
==================================

* ``website_portal_sale`` および ``invoice_payment_receipt`` モジュールに依存。

* テンプレート ``portal_my_invoices`` を継承し、請求書ステータスが「入金済」であれば既存のカラムに「領収書ダウンロード」ボタンを表示するよう調整。

* 「領収書ダウンロード」ボタンの参照先URLに紐付くメソッド（ ``print_invoice`` ）を定義し、その中で ``invoice_payment_receipt`` で追加された領収書レポートIDを指定し、PDFファイルをダウンロードするよう指定。


DB変更点
========

特になし。
